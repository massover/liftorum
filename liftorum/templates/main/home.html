{% extends 'base.html' %}

{% block content %}
<div class="feed">
{% for lift in lifts.items %}
    <strong>{{ lift.user.username }}</strong>
    <span class="text-muted pull-right">
        {{ lift.created_at|timesince }}
        {% if lift.user.id == current_user.id %}
        <div class="dropdown" style="display: inline;">
          <button class="btn btn-default btn-sm dropdown-toggle" type="button" id="lift-{{ lift.id }}-dropdown-menu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="lift-{{ lift.id }}-dropdown-menu">
            <li><a href="{{ url_for('main.delete_lift', id=lift.id) }}">Delete</a></li>
          </ul>
        </div>
        {% endif %}
    </span>
    <p>{{ lift.weight }} pound {{ lift.name }} for {{ lift.reps }} reps</p>
    {% if lift.video %}
        <div class="embed-responsive embed-responsive-16by9">
            <video src="{{ lift.video.src }}" controls="true"></video>
        </div>
    <br>
    {% endif %}
    {% for comment in lift.comments %}
        <strong>{{ comment.user.username }}</strong>
        <span class="text-muted pull-right">
            {{ comment.created_at|timesince }}
            {% if comment.user.id == current_user.id %}
            <div class="dropdown" style="display: inline;">
              <button class="btn btn-default btn-sm dropdown-toggle" type="button" id="comment-{{ comment.id }}-dropdown-menu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="comment-{{ comment.id }}-dropdown-menu">
                <li><a href="{{ url_for('main.delete_comment', id=comment.id) }}">Delete</a></li>
              </ul>
            </div>
            {% endif %}
        </span>
        <p>{{ comment.text }}</p>
    {% endfor %}
    <form action="#" method="post">
        {{ comment_form.csrf_token }}
        {{ comment_form.lift_id(value=lift.id) }}
        <div class="input-group">
            <textarea class="form-control custom-control" rows="1" name="text"></textarea>
            <span class="input-group-btn">
                <button type="submit" class="btn btn-default" type="button">
                    Comment
                </button>
            </span>
        </div>
    </form>
    <hr>
{% endfor %}
{% from "bootstrap/pagination.html" import render_pagination %}
{{ render_pagination(lifts) }}
</div>
{% endblock %}
